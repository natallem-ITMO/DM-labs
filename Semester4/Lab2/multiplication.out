start: 	S
accept: END
reject: R
blank: _

S 0 -> INIT 0 < 
S 1 -> INIT 1 <

INIT _ -> INIT2 + <

INIT2 _ -> RETURNTOPOINT 0 >

RETURNTOPOINT + -> TOSTAR + >


TOSTAR 1 -> TOSTAR 1 >
TOSTAR 0 -> TOSTAR 0 >
TOSTAR * -> TORIGHTEND * >

TORIGHTEND 1 -> TORIGHTEND 1 >
TORIGHTEND 0 -> TORIGHTEND 0 >
TORIGHTEND _ -> MINUS _ <

MINUS 1 -> CANADDRETURNTOPLUSCLEANRIGHT 0 <
MINUS 0 -> FINDNOTNULL 1 <

FINDNOTNULL 1 -> CANADDRETURNTOPLUSCLEANRIGHT 0 <
FINDNOTNULL 0 -> FINDNOTNULL 1 <
FINDNOTNULL * -> SHOWRES * >

CANADDRETURNTOPLUSCLEANRIGHT 1 -> CANADDRETURNTOPLUSCLEANRIGHT 1 <
CANADDRETURNTOPLUSCLEANRIGHT 0 -> CANADDRETURNTOPLUSCLEANRIGHT 0 <
CANADDRETURNTOPLUSCLEANRIGHT * -> STARTADD * <

STARTADD 0 -> ADD0TOPLUS 0D <
STARTADD 1 -> ADD1TOPLUS 1D <

ADD0TOPLUS 0 -> ADD0TOPLUS 0 <
ADD0TOPLUS 1 -> ADD0TOPLUS 1 <
ADD0TOPLUS + -> ADD0TONUM + <

ADD1TOPLUS 0 -> ADD1TOPLUS 0 <
ADD1TOPLUS 1 -> ADD1TOPLUS 1 <
ADD1TOPLUS + -> ADD1TONUM + <

ADD0TONUM 0A -> ADD0TONUM 0A <
ADD0TONUM 1A -> ADD0TONUM 1A <
ADD0TONUM 1 -> RETURNTOPLUSFROMLEFT 1A >
ADD0TONUM 0 -> RETURNTOPLUSFROMLEFT 0A >
ADD0TONUM _ -> RETURNTOPLUSFROMLEFT 0A >

ADD1TONUM 0A -> ADD1TONUM 0A <
ADD1TONUM 1A -> ADD1TONUM 1A <
ADD1TONUM 1 -> HASONE 0A <
ADD1TONUM 0 -> RETURNTOPLUSFROMLEFT 1A >
ADD1TONUM _ -> RETURNTOPLUSFROMLEFT 1A >

HASONE 1 -> HASONE 0 <
HASONE 0 -> RETURNTOPLUSFROMLEFT 1 >
HASONE _ -> RETURNTOPLUSFROMLEFT 1 >

RETURNTOPLUSFROMLEFT 1A -> RETURNTOPLUSFROMLEFT 1A >
RETURNTOPLUSFROMLEFT 0A -> RETURNTOPLUSFROMLEFT 0A >
RETURNTOPLUSFROMLEFT 1 -> RETURNTOPLUSFROMLEFT 1 >
RETURNTOPLUSFROMLEFT 0 -> RETURNTOPLUSFROMLEFT 0 >
RETURNTOPLUSFROMLEFT + -> FINDSMTHTOADD + >

FINDSMTHTOADD 1 -> FINDSMTHTOADD 1 >
FINDSMTHTOADD 0 -> FINDSMTHTOADD 0 >
FINDSMTHTOADD 1D -> RETURNTOPREV 1D <
FINDSMTHTOADD 0D -> RETURNTOPREV 0D <

RETURNTOPREV + -> CLEANLEFTPLUS + <
RETURNTOPREV 1 -> ADD1TOPLUS 1D <
RETURNTOPREV 0 -> ADD0TOPLUS 0D <

CLEANLEFTPLUS 1A -> CLEANLEFTPLUS 1 <
CLEANLEFTPLUS 0A -> CLEANLEFTPLUS 0 <
CLEANLEFTPLUS 0 -> RETURNTOPLUSCLEANRIGHT 0 >
CLEANLEFTPLUS 1 -> RETURNTOPLUSCLEANRIGHT 1 >
CLEANLEFTPLUS _ -> RETURNTOPLUSCLEANRIGHT _ >

RETURNTOPLUSCLEANRIGHT 0 -> RETURNTOPLUSCLEANRIGHT 0 >
RETURNTOPLUSCLEANRIGHT 1 -> RETURNTOPLUSCLEANRIGHT 1 >
RETURNTOPLUSCLEANRIGHT + -> CLEANRIGHT + >

CLEANRIGHT 1D -> CLEANRIGHT 1 >
CLEANRIGHT 0D -> CLEANRIGHT 0 >
CLEANRIGHT * -> TORIGHTEND * >

SHOWRES 1 -> SHOWRES _ >
SHOWRES 0 -> SHOWRES _ >
SHOWRES _ -> RETURNANDCLEAN _ <

RETURNANDCLEAN _ -> RETURNANDCLEAN _ <
RETURNANDCLEAN * -> CLEANTILLPLUS _ <

CLEANTILLPLUS 1 -> CLEANTILLPLUS _ <
CLEANTILLPLUS 0 -> CLEANTILLPLUS _ <
CLEANTILLPLUS + -> FINDLEFTEND _ <

FINDLEFTEND 1 -> FINDLEFTEND 1 <
FINDLEFTEND 0 -> FINDLEFTEND 0 <
FINDLEFTEND _ -> END _ >